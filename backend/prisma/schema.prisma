// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

// Enums
enum RoomStatus {
  AVAILABLE
  OCCUPIED
  FULL
  MAINTENANCE
}

enum RoomType {
  SHARED
  PRIVATE
}

enum RentalMode {
  PER_BED
  WHOLE_ROOM
}

enum BoarderStatus {
  ACTIVE
  MOVE_OUT_NOTICE
  MOVED_OUT
}

enum PaymentStatus {
  PENDING
  PAID
  OVERDUE
  PARTIAL
}

enum PaymentType {
  RENT
  UTILITY
  DEPOSIT
  OTHER
}

enum UtilityType {
  ELECTRICITY
  WATER
  WIFI
  OTHER
}

enum BillingMode {
  FLAT_RATE
  PER_UNIT
  SPLIT
}

// Models
model Room {
  id           Int        @id @default(autoincrement())
  roomNumber   String     @unique @map("room_number")
  capacity     Int        @default(4)
  type         RoomType   @default(SHARED)
  rentalMode   RentalMode @default(PER_BED) @map("rental_mode")
  monthlyRent  Decimal    @default(600) @map("monthly_rent") @db.Decimal(10, 2)
  status       RoomStatus @default(AVAILABLE)
  createdAt    DateTime   @default(now()) @map("created_at")
  updatedAt    DateTime   @updatedAt @map("updated_at")
  
  boarders     Boarder[]
  
  @@map("rooms")
}

model Boarder {
  id               Int           @id @default(autoincrement())
  firstName        String        @map("first_name")
  lastName         String        @map("last_name")
  email            String?
  phone            String?
  sex              String?
  idType           String?       @map("id_type")
  idNumber         String?       @map("id_number")
  emergencyContact String?       @map("emergency_contact")
  moveInDate       DateTime      @map("move_in_date")
  moveOutDate      DateTime?     @map("move_out_date")
  contractDuration Int           @default(12) @map("contract_duration")
  rentalType       RentalMode    @default(PER_BED) @map("rental_type")
  bedSpaces        Int           @default(1) @map("bed_spaces")
  roomId           Int           @map("room_id")
  status           BoarderStatus @default(ACTIVE)
  shareableLink    String?       @unique @map("shareable_link")
  createdAt        DateTime      @default(now()) @map("created_at")
  updatedAt        DateTime      @updatedAt @map("updated_at")
  
  room             Room          @relation(fields: [roomId], references: [id], onDelete: Cascade)
  payments         Payment[]
  
  @@map("boarders")
}

model Payment {
  id          Int           @id @default(autoincrement())
  boarderId   Int           @map("boarder_id")
  amount      Decimal       @db.Decimal(10, 2)
  paidAmount  Decimal?      @map("paid_amount") @db.Decimal(10, 2)
  dueDate     DateTime      @map("due_date")
  paymentDate DateTime?     @map("payment_date")
  paymentType PaymentType   @default(RENT) @map("payment_type")
  status      PaymentStatus @default(PENDING)
  notes       String?
  createdAt   DateTime      @default(now()) @map("created_at")
  updatedAt   DateTime      @updatedAt @map("updated_at")
  
  boarder     Boarder       @relation(fields: [boarderId], references: [id], onDelete: Cascade)
  
  @@map("payments")
}

model Utility {
  id          Int         @id @default(autoincrement())
  type        UtilityType
  billingMode BillingMode @default(SPLIT) @map("billing_mode")
  monthlyRate Decimal?    @map("monthly_rate") @db.Decimal(10, 2)
  unitRate    Decimal?    @map("unit_rate") @db.Decimal(10, 2)
  amount      Decimal?    @db.Decimal(10, 2)
  month       String?
  year        Int?
  createdAt   DateTime    @default(now()) @map("created_at")
  updatedAt   DateTime    @updatedAt @map("updated_at")
  
  @@map("utilities")
}
